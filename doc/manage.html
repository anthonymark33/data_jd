<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>Jd Ops manage</title>
<link rel="stylesheet" href="jda.css" type="text/css">

<body>
<div class=masthead>
<img src="./jblue.png" width="50px" height="50px"/>
<span class=md>d</span>
<span class=mt>&nbsp;Ops manage</span>
<span class=ms><a href="http://www.jsoftware.com" target="_blank">www.jsoftware.com</a><br>J database - J language<br>columnar analytics</span>
</div>

<div contenteditable="false">
<code>
<a href="#close">close</a>
<a href="#createcol">createcol</a> <a href="#createdb">createdb</a> <a href="#createtable">createtable</a>
<a href="#dropcol">dropcol</a> <a href="#dropdb">dropdb</a> <a href="#dropfilesize">dropfilesize</a> <a href="#droptable">droptable</a>
<a href="#renamecol">renamecol</a> <a href="#renametable">renametable</a>

<hr><a name="createcol"><h2>createcol</h2></a>
createcol table col type [trailing-shape] [data]
 
creates new col with type and trailing-shape
col has default data or the arg data

data requires trailing-shape and _ indicates empty

data includes deleted rows (similar to get/set)

NB. example createcol
jdadminx'example'[olddan=:jdaccess''
jd'createtable f'
jd'createcol f a int'
jd'insert f a';12 13 14
jd'createcol f b int'
jd'createcol f c int 2'
jd'createcol f d int _';88 89 90
jd'createcol f e int 2';100+i.3 2
jd'reads from f'
jdaccess olddan

<hr><a name="createdb"><h2>createdb</h2></a>
createdb

valid only after a dropdb
creates filefolder and initial files
gets lock

<hr><a name="createtable"><h2>createtable</h2></a>
createtable [/a MIN MULT XTRA] table [coldefs]

createtable with 0 or more cols
each col defined by: col type [trailing-shape]

string arg coldefs separated by , or LF
boxed arg coldefs in separate boxes

/a parameters are: MIN-minimum rows, MULT-multiplier, XTRA-extra rows
when insert requires mapped col file resize, new size is:
   MIN>.>.MULT*XTRA+current_rows+new_rows

default alloc is 2000 1.5 0

NB. example createtable
jdadminx'example'[olddan=:jdaccess''
jd'createtable f'
jd'createtable g a int , b int 2'
jd'createtable h';'a int';'b int 2'
t=: 0 : 0
a int
b int 2
)
jd'createtable i ',t
jd'info schema'
jdaccess olddan

<hr><a name="dropcol"><h2>dropcol</h2></a>
dropcol table col
OK if col does not exist
error if col is used in hash or reference

<hr><a name="dropdb"><h2>dropdb</h2></a>
drops each col of each table
releases lock
deletes filefolder

<hr><a name="dropfilesize"><h2>dropfilesize</h2></a>
dropfilesize

files tend to be kept larger than required
data in the file can grow without having to resize/remap

dropfilesize frees up unused file space - use if a db is static

dropfilesize returns filenames, old size, new size

<hr><a name="droptable"><h2>droptable</h2></a>
droptable [/reset] table

/reset preserves schema
 drops rows
 drops dynamic hash/unique/... cols
 keeps filesize

OK if table does not exist
error if table has reference (refers to or referred by)

<hr><a name="renamecol"><h2>renamecol</h2></a>
renamecol table col newname
error if col is used in hash or reference

<hr><a name="renametable"><h2>renametable</h2></a>
renametable table newname
error if the table is used in reference
</code></div></div></body></html>