<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>Jd Ops dynamic</title>
<link rel="stylesheet" href="jda.css" type="text/css">

<body>
<div class=masthead>
<img src="./jblue.png" width="50px" height="50px"/>
<span class=md>d</span>
<span class=mt>&nbsp;Ops dynamic</span>
<span class=ms><a href="http://www.jsoftware.com" target="_blank">www.jsoftware.com</a><br>J database - J language<br>columnar analytics</span>
</div>

<div contenteditable="false">
<code>
<a href="#createdynamic">createdynamic</a> <a href="#createhash">createhash</a> <a href="#createunique">createunique</a> <a href="#dropdynamic">dropdynamic</a> <a href="#ref">ref</a> <a href="#reference">reference</a>

dynamic cols are system cols that are built from data cols
dynamic cols are updated when the underlying data cols change

<hr><a name="createdynamic"><h2>createdynamic</h2></a>
createdynamic

does dropdynamic to drop existing dynamic cols
runs db dynamic verb (custom.ijs) to create dynamic cols

<hr><a name="createhash"><h2>createhash</h2></a>
createhash [/nc n] t1 cols...

creates hash col based on 1 or more data cols
hash on col a is named jdhash_a
hash on cols a and b is names jdhash_a_b
hash col has 2 mapped nouns hash and link

#hash created as 2*#col (few collisions)
#hash resized when insert reduces 2 to 1.5 (more collisions)

#link same as #col and links rows with the same values

/nc integer treated as max #nub cols...

if #nub cols... is much less than 0.25*#col
then building smaller hash with /nc is much faster 

/nc 10000 creates hash with 4*10000 entries
if #nub cols... is <10000 then hash will have very few collisions
and will build much faster than hash with 2*#col entries

tutorial hash


<hr><a name="createunique"><h2>createunique</h2></a>
createunique t1 cols...

same as <a href="#createhash">createhash</a> except no link for dups
and col name is jdunique_... instead of jdhash_...

if cols... are not unique then earlier dup rows are deleted
and the op completes with an error warning

tutorial unique
<hr><a name="dropdynamic"><h2>dropdynamic</h2></a>
dropdynamic [type spec]

dropdynamic with no argument drops all dynamic cols
dropdynamic with argument drops specified dynamic col

spec is the argument used to create the dynamic col

dropdynamic ref       tab1 cols    tab2 cols
dropdynamic reference tab1 cols... tab2 cols...
dropdynamic hash      tab1 cols...
dropdynamic reference tab1 cols...

A dropdynamic of a reference does not drop the associated hash dynamic cols.

<hr><a name="ref"><h2>ref</h2></a>
ref tab1 col1 tab2 col2

ref is simpler than reference and is prefered if it does the job

ref runs much faster than reference

ref takes much less disk space than reference
 does not have left/right hash/link cols
 creates single dynamic int col


ref restrictions: only single col and only left1 <a href="use.html#from">from join</a>

ref left1 refers to last row in the right table that matches (i: not i.)

reference left1 refers to first (or random after changes) row
in the right table that matches

insert/delete/update to either table sets dirty flag
 ref col recalculated (leftcols i: rightcols) when required
 
future release might support dynamic update and avoid dirty flag rebuilds

see <a href="technical.html#ref">Technical|ref</a> for details<br>
<hr><a name="reference"><h2>reference</h2></a>
reference t1 cols... t2 cols...

allows outer/inner/left/right/left1 <a href="use.html#from">from join</a>
does createhash if required
uses previous createunique
inserts/deletes/updates update dynamic cols as required

tutorial reference
</code></div></div></body></html>
